# ğŸš€ æ•°æ®åº“å¿«é€Ÿå¯åŠ¨æŒ‡å—

## å½“å‰çŠ¶æ€

âœ… **æ•°æ®åº“å·²åˆå§‹åŒ–å®Œæˆ**
âœ… **æ‰€æœ‰æµ‹è¯•é€šè¿‡**
â³ **ç­‰å¾…é…ç½®RDSç™½åå•**

## ä¸€é”®å‘½ä»¤

### éªŒè¯æ•°æ®åº“
```bash
npm run db:verify
```

### æµ‹è¯•åº”ç”¨è¿æ¥
```bash
npm run db:test
```

### æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
```bash
npm run db:check
```

### å¯åŠ¨APIå¼€å‘æœåŠ¡å™¨
```bash
npm run dev:api
```

## é…ç½®RDSç™½åå•ï¼ˆé‡è¦ï¼ï¼‰

### æ­¥éª¤1ï¼šè·å–ä½ çš„IPåœ°å€
```bash
# Windows
curl ifconfig.me

# æˆ–è®¿é—®
# https://www.whatismyip.com/
```

### æ­¥éª¤2ï¼šé…ç½®é˜¿é‡Œäº‘RDS
1. è®¿é—®ï¼šhttps://rdsnext.console.aliyun.com/
2. æ‰¾åˆ°å®ä¾‹ï¼š`pgm-wz9z6i202l2p25wvco`
3. ç‚¹å‡»"æ•°æ®å®‰å…¨æ€§" â†’ "ç™½åå•è®¾ç½®"
4. ç‚¹å‡»"ä¿®æ”¹"
5. æ·»åŠ ä½ çš„IPåœ°å€ï¼ˆæˆ– `0.0.0.0/0` ç”¨äºæµ‹è¯•ï¼‰
6. ç‚¹å‡»"ç¡®å®š"

### æ­¥éª¤3ï¼šæµ‹è¯•è¿æ¥
```bash
npm run dev:api
```

è®¿é—®ï¼šhttp://localhost:3001/test-db-api.html

## æµ‹è¯•ç»“æœ

### å·²é€šè¿‡çš„æµ‹è¯• âœ…

```bash
$ npm run db:test

ğŸ§ª æµ‹è¯•åº”ç”¨æ•°æ®åº“è¿æ¥
============================================================

ğŸ“Œ æµ‹è¯• 1: æ•°æ®åº“è¿æ¥
   âœ… è¿æ¥æˆåŠŸ

ğŸ“Œ æµ‹è¯• 2: åˆ›å»ºæ–°ç©å®¶
   âœ… ç©å®¶åˆ›å»ºæˆåŠŸ

ğŸ“Œ æµ‹è¯• 3: åˆ›å»ºæ¸¸æˆä¼šè¯
   âœ… ä¼šè¯åˆ›å»ºæˆåŠŸ

ğŸ“Œ æµ‹è¯• 4: æ·»åŠ ç­”æ¡ˆç»„åˆ
   âœ… ç­”æ¡ˆç»„åˆåˆ›å»ºæˆåŠŸ

ğŸ“Œ æµ‹è¯• 5: æ›´æ–°æ¸¸æˆä¼šè¯
   âœ… ä¼šè¯æ›´æ–°æˆåŠŸ

ğŸ“Œ æµ‹è¯• 6: æŸ¥è¯¢æ’è¡Œæ¦œ
   âœ… æ’è¡Œæ¦œæŸ¥è¯¢æˆåŠŸ

ğŸ“Œ æµ‹è¯• 7: æŸ¥è¯¢æ¸¸æˆç»Ÿè®¡
   âœ… ç»Ÿè®¡æŸ¥è¯¢æˆåŠŸ

ğŸ“Œ æµ‹è¯• 8: æŸ¥è¯¢ç©å®¶æ¸¸æˆå†å²
   âœ… å†å²æŸ¥è¯¢æˆåŠŸ

ğŸ“Œ æµ‹è¯• 9: äº‹åŠ¡å¤„ç†
   âœ… äº‹åŠ¡å›æ»šæˆåŠŸ

ğŸ“Œ æµ‹è¯• 10: æ¸…ç†æµ‹è¯•æ•°æ®
   âœ… æµ‹è¯•æ•°æ®æ¸…ç†æˆåŠŸ

============================================================
ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼
============================================================
```

## å½“å‰æ•°æ®

```bash
$ npm run db:verify

âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ

ğŸ‘¥ ç©å®¶åˆ—è¡¨:
   1. æµ‹è¯•ç©å®¶1
   2. æµ‹è¯•ç©å®¶2
   3. AIä¾¦æ¢
   4. ç”»å¸ˆçŒäºº

ğŸ† æ’è¡Œæ¦œ:
   1. æµ‹è¯•ç©å®¶2 - 68åˆ† (9ç»„)
   2. æµ‹è¯•ç©å®¶1 - 48åˆ† (9ç»„)
   3. AIä¾¦æ¢ - 32åˆ† (9ç»„)

ğŸ“Š æ¸¸æˆç»Ÿè®¡:
   æ€»ç©å®¶æ•°: 4
   å¹³å‡åˆ†æ•°: 49.3
   æœ€é«˜åˆ†æ•°: 68
   å®Œæˆç‡: 100%
```

## æ•°æ®åº“ä¿¡æ¯

```
ä¸»æœº: pgm-wz9z6i202l2p25wvco.pg.rds.aliyuncs.com
ç«¯å£: 5432
æ•°æ®åº“: aki
ç”¨æˆ·: aki
Schema: public
```

## è¡¨ç»“æ„

### playersï¼ˆç©å®¶è¡¨ï¼‰
- id (SERIAL)
- nickname (VARCHAR)
- created_at, updated_at (TIMESTAMP)

### game_sessionsï¼ˆæ¸¸æˆä¼šè¯è¡¨ï¼‰
- id (SERIAL)
- player_id (å¤–é”®)
- total_score, combinations_count (INTEGER)
- completed_at, created_at (TIMESTAMP)

### answer_combinationsï¼ˆç­”æ¡ˆç»„åˆè¡¨ï¼‰
- id (SERIAL)
- session_id (å¤–é”®)
- card_ids (TEXT[])
- ai_marked_card_id (TEXT)
- is_grouping_correct, is_ai_detection_correct (BOOLEAN)
- score (INTEGER)
- created_at (TIMESTAMP)

### leaderboardï¼ˆæ’è¡Œæ¦œè§†å›¾ï¼‰
- nickname, total_score, combinations_count
- completed_at, rank

### game_statsï¼ˆç»Ÿè®¡è§†å›¾ï¼‰
- total_players, average_score, highest_score
- completion_rate, ai_detection_accuracy

## ä¸‹ä¸€æ­¥

### 1. é…ç½®ç™½åå•å
```bash
# å¯åŠ¨APIæœåŠ¡å™¨
npm run dev:api

# åœ¨æµè§ˆå™¨æ‰“å¼€
# http://localhost:3001/test-db-api.html
```

### 2. é›†æˆåˆ°åº”ç”¨
æ›´æ–° `.env`ï¼š
```env
VITE_USE_DIRECT_DB=true
```

### 3. éƒ¨ç½²åˆ°ç”Ÿäº§
```bash
# å®‰è£…Vercel CLI
npm install -g vercel

# éƒ¨ç½²
vercel --prod
```

## æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šè¿æ¥è¶…æ—¶
```
âŒ Connection terminated due to connection timeout
```

**è§£å†³**ï¼šé…ç½®é˜¿é‡Œäº‘RDSç™½åå•

### é—®é¢˜ï¼šæƒé™é”™è¯¯
```
âŒ permission denied for schema public
```

**è§£å†³**ï¼šç¡®ä¿ä½¿ç”¨ `aki` æ•°æ®åº“ï¼ˆå·²é…ç½®ï¼‰

### é—®é¢˜ï¼šæ‰¾ä¸åˆ°è¡¨
```
âŒ relation "players" does not exist
```

**è§£å†³**ï¼šè¿è¡Œåˆå§‹åŒ–è„šæœ¬
```bash
npm run db:init
```

## æœ‰ç”¨çš„é“¾æ¥

- ğŸ“– [å®Œæ•´æ–‡æ¡£](./APPLICATION_CONNECTION_READY.md)
- ğŸ” [æµ‹è¯•æŠ¥å‘Š](./DATABASE_CONNECTION_TEST_REPORT.md)
- âœ… [åˆå§‹åŒ–æŠ¥å‘Š](./DATABASE_INIT_SUCCESS.md)
- ğŸ—„ï¸ [æ•°æ®åº“è®¾è®¡](./database/DATABASE_DESIGN.md)

## è”ç³»æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥ `.env` é…ç½®
2. è¿è¡Œ `npm run db:check`
3. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
4. å‚è€ƒæ•…éšœæ’æŸ¥éƒ¨åˆ†

---

**å‡†å¤‡å°±ç»ªï¼** ğŸ‰ é…ç½®ç™½åå•åå³å¯å¼€å§‹ä½¿ç”¨ã€‚
